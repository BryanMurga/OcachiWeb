<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Descarga de registros Ocachi Nueva Escuela</title>
    <link href="img/logoOcachiIcon.jpg" rel="icon" />

    <!-- Bootstrap CSS (opcional; puedes cambiar estilos) -->

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- flatpickr (selector de fechas) -->

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />

    <style>
      body {
        background: #f7f9fc;
      }
      .card {
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(20, 30, 60, 0.08);
      }
      .muted {
        color: #6c757d;
        font-size: 0.95rem;
      }
      .form-section {
        max-width: 780px;
        margin: 28px auto;
      }
      .flatpickr-wrapper {
        width: 100%;
      }
      .visually-hidden {
        position: absolute !important;
        height: 1px;
        width: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
      }
    </style>
  </head>
  <body>
    <main class="form-section">
      <div class="text-center mb-4">
        <img
          src="img/ocachiLogo.webp"
          alt="Logo Ocachi"
          style="max-width: 180px; height: auto"
        />
      </div>
      <div class="card p-4">
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <h4 class="mb-2">Exportar registros</h4>
            <p class="muted mb-3">
              Selecciona el rango de fechas de los registros que quieres
              descargar.
            </p>

            <!-- Calendario / selector de rango -->
            <label for="dateRange" class="form-label visually-hidden"
              >Rango de fechas</label
            >
            <input
              id="dateRange"
              class="form-control py-3 flatpickr-wrapper"
              placeholder="Selecciona rango de fechas"
              aria-describedby="dateHelp"
              readonly
            />

            <div id="dateHelp" class="form-text mt-2 muted">
              Formato: selección de fecha inicio — fin.
            </div>

            <!-- Mensaje de rango -->
            <div id="rangeInfo" class="mt-3"></div>
          </div>

          <div class="col-12 col-md-6">
            <h5 class="mb-2">Autenticación</h5>
            <p class="muted mb-3">
              Introduce tus credenciales para autorizar la descarga.
            </p>

            <form id="loginForm" autocomplete="on" novalidate>
              <div class="mb-3">
                <label for="email" class="form-label">Correo electrónico</label>
                <input
                  type="email"
                  id="email"
                  class="form-control"
                  placeholder="Ingresa tu correo"
                  required
                  aria-required="true"
                />
                <div id="usernameError" class="text-danger small d-none">
                  Ingresa un usuario válido.
                </div>
              </div>

              <div class="mb-3">
                <label for="password" class="form-label">Contraseña</label>
                <input
                  type="password"
                  id="password"
                  class="form-control"
                  placeholder="Contraseña"
                  required
                  aria-required="true"
                />
                <div id="passwordError" class="text-danger small d-none">
                  Ingresa la contraseña.
                </div>
              </div>

              <div class="d-grid gap-2">
                <button type="submit" id="loginBtn" class="btn btn-primary">
                  Iniciar sesión
                </button>
              </div>

              <div
                id="loginFeedback"
                class="mt-2"
                role="status"
                aria-live="polite"
              ></div>
            </form>

            <!-- Selector de colección y botón de descarga -->
            <div class="mb-3">
              <label for="collectionSelect" class="form-label">Colección a descargar</label>
              <select id="collectionSelect" class="form-select">
                <option value="">Selecciona una colección</option>
                <option value="registros">Registros</option>
                <option value="talleres">Talleres</option>
              </select>
              <small class="text-muted">Elige si deseas exportar registros o talleres.</small>
            </div>

            <hr />

            <div class="d-grid gap-2 mt-2">
              <button id="downloadBtn" class="btn btn-outline-success" disabled>
                Descargar datos (.csv)
              </button>
              <small id="downloadHint" class="muted"
                >El botón se activará cuando inicies sesión y selecciones un
                rango.</small
              >
            </div>

            <div
              id="downloadFeedback"
              class="mt-2"
              role="status"
              aria-live="polite"
            ></div>
          </div>
        </div>
      </div>
    </main>

    <!-- Librerías -->

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <!-- Option: Spanish locale for flatpickr -->

    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <!-- Bootstrap JS bundle (opcional) -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Importa tu inicialización -->
    <script type="module" src="js/firebase.js"></script>
    <!-- Script de autenticación -->
    <script type="module" src="js/login.js"></script>
    <script type="module" src="js/export.js"></script>
  </body>
</html>
